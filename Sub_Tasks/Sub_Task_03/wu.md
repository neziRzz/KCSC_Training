# Math
## Misc
## Detailed Analysis
## Script and Flag
```python
def ror(val, bits, bit_size):
    return ((val & (2 ** bit_size - 1)) >> bits % bit_size) | \
           (val << (bit_size - (bits % bit_size)) & (2 ** bit_size - 1))
cyphertext = [0xE5, 0xA8, 0x07, 0x2E, 0xE8, 0x67, 0xB5, 0x0C, 0xF9, 0x05, 
  0xA1, 0xA8, 0xFA, 0x05, 0x0A, 0x66, 0xA0, 0xC1, 0x20, 0x4E, 
  0xE3, 0x7D, 0xD0, 0x04, 0x21, 0x67, 0xEC, 0x9E, 0x7D, 0xBC, 
  0x2D, 0x8D, 0x9B, 0x65, 0xDC, 0x71, 0xE4, 0x57, 0x81, 0x11, 
  0x1A, 0x71, 0x7F, 0x84, 0x2C, 0x88, 0x25, 0x94]
map = [0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 
  0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 
  0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 
  0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 
  0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 
  0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 
  0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 
  0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 
  0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 
  0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 
  0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 
  0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 
  0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 
  0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 
  0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 
  0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 
  0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 
  0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 
  0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 
  0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 
  0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 
  0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 
  0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 
  0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 
  0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 
  0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16]
dest = [0]*len(cyphertext)
for i in range(0,len(cyphertext),8):
  v1 = cyphertext[i]
  v2 = cyphertext[i+1]
  v18 = ord("c")
  v17 = ord("o")
  v3 = cyphertext[i+2]
  v16 = ord("n")
  v4 = cyphertext[i+3]
  v15 = ord("f")
  v5 = cyphertext[i+4]
  v14 = ord("u")
  v6 = cyphertext[i+5]
  v7 = ord("s")
  v8 = cyphertext[i+6]
  v9 = ord("e")
  result = cyphertext[i+7]
  v11 = ord("d")
  v12 = 100
  while(v12):
    v1 = 0xFF&(ror(v1, 1, 8)) - map[(v11 + result)&0xFF] 
    result = 0xFF&ror(result, 1, 8) - map[(v9 + v8)&0xFF] 
    v8 = 0xFF&ror(v8, 1, 8) - map[(v6 + v7)&0xFF] 
    v6 = 0xFF&ror(v6, 1, 8) - map[(v5 + v14)&0xFF] 
    v5 = 0xFF&ror(v5, 1, 8) - map[(v4 + v15)&0xFF] 
    v4 = 0xFF&ror(v4, 1, 8) - map[(v3 + v16)&0xFF] 
    v3 = 0xFF&ror(v3, 1, 8) - map[(v2 + v17)&0xFF] 
    v2 = 0xFF&ror(v2, 1, 8) - map[(v1 + v18)&0xFF] 
    v12 -=1
  dest[i]=v1
  dest[i+1]=v2
  dest[i+2]=v3
  dest[i+3]=v4
  dest[i+4]=v5
  dest[i+5]=v6
  dest[i+6]=v8
  dest[i+7]=result
for i in dest:
  print(chr(i),end='')
```
# Math 2
## Detailed Analysis
## Script and Flag
```python
# find v26 phase
from z3 import *
v9 = 513
def Pad7Bit(a1):
    a1 &= 0xFF
    return a1 & 1 | (((a1&0xFFFFFFFFFFFFFFFF) & 0x7F) << 32) & 0x1000000001 | ((a1 & 0xF | (((a1&0xFFFFFFFFFFFFFFFF) & 0x7F) << 32) & 0x700000000F) << 16) & 0x40001000040001 | ((a1 & 3 | (((a1&0xFFFFFFFFFFFFFFFF) & 0x7F) << 32) & 0x3000000003 | ((a1 & 0xF | (((a1&0xFFFFFFFFFFFFFFFF) & 0x7F) << 32) & 0x700000000F) << 16) & 0x400030000C0003) << 8) & 0x40201008040201
def EncodeMorton_9x7bit(a1,a2,a3,a4,a5,a6,a7,a8,a9):
    a1 &= 0xFF
    a2 &= 0xFF
    a3 &= 0xFF
    a4 &= 0xFF
    a5 &= 0xFF
    a6 &= 0xFF
    a7 &= 0xFF
    a8 &= 0xFF
    a9 &= 0xFF
    v9 = Pad7Bit(a1)
    v10 = (2 * Pad7Bit(a2)) | v9
    v11 = (4 * Pad7Bit(a3)) | v10
    v12 = (8 * Pad7Bit(a4)) | v11
    v13 = (16 * Pad7Bit(a5)) | v12
    v14 = (32 * Pad7Bit(a6)) | v13
    v15 = (Pad7Bit(a7) << 6) | v14
    v16 = (Pad7Bit(a8) << 7) | v15
    return v16 | (Pad7Bit(a9) << 8)
v26 = [BitVec('x[%d]'%i,64) for i in range(8*(336%512))]
s = Solver()
correct = [0x00022640ABA57200, 0x0008004479D42852, 0x000880054948C092, 0x0008A41420193A02, 0x00400541D1E04050, 0x004821117A352810, 0x004A0044C8404A12, 0x004A245518302A90, 0x004A24557B20D892, 0x004A2650E3796050,
0x010A01442864E2D0, 0x0108A505E86D6802, 0x0108A50451E1C880, 0x0108A505F3EC4010, 0x0108A70169E13012, 0x0108A7011AF138D0, 0x0108860412910010, 0x01422700D0B40812, 0x0142865141E590C0, 0x0142A44551DCE092,
0x0148A455682D2000, 0x014A2545A205AA92, 0x0400A0550A055212, 0x0402A1044BEC02C2, 0x0408250471C01280, 0x04088145FB0D1852, 0x0408834010DC50C0, 0x04088211F1A83012, 0x050227401A7400C2, 0x050202007AA948C0,
0x0500835170E80042, 0x044A071423453280, 0x0448A30420E53000, 0x0442A601BA382A52, 0x04422751CA9DDAD0, 0x0442045472A068C0, 0x0442810491C9B012, 0x0448245568915880, 0x044A2044C9FDE000, 0x0500054449210290,
0x0502044461B93242, 0x0548851463309A82, 0x054825446B34E012, 0x05482105BA4CB042, 0x0548230008D5C852, 0x0548230018DCF292, 0x0548261528B93800, 0x054807559B9928D0, 0x0542A4D162197A02, 0x054801913325BA90,
0x0548848189197012, 0x054A8614B1ACB202, 0x1002A31432D18890, 0x1008074499F8B090, 0x054A8304B2D578C0, 0x0540A75590C45A40, 0x054023543B083AD0, 0x050826453AF42010, 0x1048A00422488082, 0x10488015436C0082,
0x1048235023E1B840, 0x104822401ABC48C2, 0x1048071423B4E252, 0x10480714F370E090, 0x104821D022ADEAD2, 0x1048A5D190B072D0, 0x104A81D0D074A850, 0x1102219079E8F2D2, 0x110884C1BB8C0212, 0x1108A61051C988C2,
0x11020650F2100800, 0x104A824071B45812, 0x10420700D1893A50, 0x10402750F19DF080, 0x100A8600D00128C0, 0x14088401FB31D250, 0x14082101FB75B802, 0x114AA544C324F200, 0x140000546A19E842, 0x14000515BA2972C2,
0x1400071099100A42, 0x114AA740731408C0, 0x114A82017160EA10, 0x1142230402F4C850, 0x11408705A135F240, 0x1140A654614C0A80, 0x1148830563BD5A52, 0x114A831519A56080, 0x14002355F03950D2, 0x14008091E8EDD210,
0x1400A08032B172D2, 0x140821852BC00050, 0x144000C449118242, 0x1500001461ED8290, 0x144AA154B288C082, 0x144AA350001CD880, 0x144AA7016BE07840, 0x1500231071E41AD2, 0x150026452BECCAD2, 0x144AA58039586A52,
0x150024C17A053A42, 0x150024C173551A12, 0x150A25150A45F2D0, 0x154005558B45C802, 0x15422005AA558842, 0x154880058B8DD252, 0x800001046854AAC0, 0x80020004E175F2C2, 0x800280544931F000, 0x8008A054C3303A00,
0x80482541A1C5D2D2, 0x8048210038A542C0, 0x80480114AA697840, 0x8042A015B3917A52, 0x804283502048A0C0, 0x8040A310F8D91240, 0x8040A314221110D2, 0x8040A644BA291890, 0x80420615197C2892, 0x804AA254FBF8A8D0,
0x8102A20478A938D2, 0x810A031539F55250, 0x81420701F81D7AD0, 0x814226501230BA12, 0x814003412855CAC0, 0x810801047A995250, 0x8100A105137DEA90, 0x814AA454F1A5D840, 0x814AA21028C50252, 0x814A8351C16C80D0,
0x814A2711F25CD250, 0x814A8245A234BAC2, 0x814A2715F195D090, 0x814A80C189F828C0, 0x840082549B2D7A50, 0x840203459138A0C0, 0x84088644D961AA00, 0x844087047B200A90, 0x8440A65453248A50, 0x8502A14533580092,
0x85020414D0E5AA40, 0x844AA1055BFCA8C2, 0x8448A6009814CA52, 0x8448A60408A56AD0, 0x844A8314B864B210, 0x85020304B2293842, 0x850803143B6DD212, 0x850A0655A1A97092, 0x85088711DAD17A12, 0x8502271050A0B880,
0x844AA30050451AC0, 0x8542A005195DB8C0, 0x8542A310022C9892, 0x8542A310B9C8D850, 0x8548260401907080, 0x854883556288F010, 0x854A05D0088D1A12, 0x854A2180C3C91A52, 0x854A859409A96052, 0x9000219468CDC212,
0x90020584302CB252, 0x900800D5E0AC2090, 0x90402494E9A49AC0, 0x904201C5A829B802, 0x9040A245B2A40280, 0x900A0744D3E8B2C2, 0x900001C029517282, 0x854024D08325CA92, 0x850A208121FC4810, 0x904A0515B26D8812,
0x904800459B3DE810, 0x9040871022A1D0C0, 0x9042A251710D0812, 0x904206516838A290, 0x904222005115C050, 0x90482344A38930C0, 0x904A0715EAE99A42, 0x910202059A1532D0, 0x9108065542FDF042, 0x910A2214A03C58D0,
0x910A221058B4F052, 0x910282503BBC9852, 0x904A82109B2412D2, 0x904A8455B9F8C2D2, 0x9100251598492A42, 0x91088414F0F52052, 0x91482545385998D2, 0x91482545710492C2, 0x91488250C36DE0D2, 0x9148A7013AC000D2,
0x914887150B09F280, 0x9148871568412290, 0x914A231480D42240, 0x94002215299CFA52, 0x9400A30508A91AC2, 0x9408870528981050, 0x940A230589CC5212, 0x940A0445B0703092, 0x9440A405100DC292, 0x94428005B9FCC8D0,
0x944884559A6D0852, 0x944A2404F21142D2, 0x9500241472CD1840, 0x9508A410F32C7AC0, 0x950885558038C840, 0x95088554B3003202, 0x95088445DA497AC2, 0x950887509075E850, 0x9508A301DBC11210, 0x9508A745E999F850,
0x9540260548056000, 0x9542A354CAC4A892, 0x95488610FAA94250, 0x954A0700985032C2, 0x9542860009D18292, 0x950AA4445B513AC2, 0x0020A75423B48880, 0x0020A640F855BA90, 0x0022260042397850, 0x002A045473F45052,
0x002AA05552306240, 0x00608310A93D4A02, 0x00622351C0388850, 0x0062A3105204EA92, 0x0062A31039B98A40, 0x006A044572B89842, 0x006AA2410204D842, 0x012002114AE010C0, 0x012222117A910282, 0x01228315298C82D0,
0x012A24057B4D32D2, 0x016002014BB03090, 0x0160020113C0B0C2, 0x012AA214E2D42082, 0x012AA214B134A812, 0x01602741DA91F0D2, 0x016803552B74DAC2, 0x016A86544B7C5292, 0x042883048301A280, 0x04282641B07D6212,
0x04288610033C4050, 0x04602150A944DA42, 0x0468805071794AD0, 0x046A24415ACC12C0, 0x05200044E35D7A02, 0x05222504F1E19AD0, 0x052A2740E0BCD090, 0x05602751192D18D0, 0x056203517A69D002, 0x0562265501008280,
0x052A8710415D8A90, 0x0528835109159840, 0x05208641A8F070D2, 0x05202211EB05D8C2, 0x046A8300D1DD1A40, 0x04688255A3ACD2C0, 0x0462A6556A442852, 0x04222745A8250AD0, 0x0420A3446BC4FA92, 0x0460814123A1FA82,
0x046205416B91E010, 0x056AA1445A453012, 0x056AA210290C1AD0, 0x056A8700600DEA92, 0x10200200704152C2, 0x10208255A09CB810, 0x102206544290C282, 0x102A865582498242, 0x10602711394CA802, 0x10602710B97190C2,
0x1060A21152D138C0, 0x10620645A3B8F052, 0x10680215A0A9EA10, 0x106A02448B0502C0, 0x106A875139187802, 0x106AA741A8892A82, 0x1120060089C18850, 0x11602455D2F84010, 0x1160875062D1FA82, 0x112AA600D9510A40,
0x112A2314C80C0A82, 0x11228241D9248A10, 0x11222601BAD46A80, 0x1122260109B060C0, 0x1128A2404870F050, 0x11688500516DAA10, 0x116A055429A87AD0, 0x116A25459248A882, 0x116A8405F2AC4AD0, 0x116AA701C8C402D0,
0x1420220153397A00, 0x142023140AB00A92, 0x14202314C1851842, 0x1420275443F1E0C0, 0x14208615EB14EA52, 0x142827054A9C98C2, 0x142A030542544280, 0x142AA65520E958C2, 0x14608710500132C2, 0x142AA651A2003252,
0x1428224002A5D0C2, 0x14202750AB94CA10, 0x1560A64548F04A00, 0x1560071439743A02, 0x1528264419ECF240, 0x15228715E3DC5810, 0x1520A3419294E0D2, 0x152223019A78A852, 0x1528861098889050, 0x152A234061A85292,
0x152A234009C57A00, 0x152824451064E0C0, 0x15200545B970F8C0, 0x15602500D3380042, 0x1560A55423398800, 0x1562A145EB6CA800, 0x15688405335C88D0, 0x156A0015F89C2890, 0x156823018B357092, 0x156226006A3D6040,
0x15680641CBF038D2, 0x156AA7111BF5B212, 0x8022865179FC2A92, 0x8022A31428A11AC0, 0x802082044AC42240, 0x156A2645EACCCA10, 0x15688254B10D5A00, 0x1568871552381810, 0x1568859162609AC0, 0x156821801B78CA50,
0x156281D1706CF892, 0x156081C5218122C0, 0x156000D5ABB11090, 0x152A24D582389002, 0x152A00C461119880, 0x0000000000000000]
for i in range(336):
    v22 = EncodeMorton_9x7bit(
    v26[8 * i] & 0x7F,
    v26[8 * (i % v9) + 1] & 0x7F,
    v26[8 * (i % v9) + 2] & 0x7F,
    v26[8 * (i % v9) + 3] & 0x7F,
    v26[8 * (i % v9) + 4] & 0x7F,
    v26[8 * (i % v9) + 5] & 0x7F,
    v26[8 * (i % v9) + 6] & 0x7F,
    v26[8 * (i % v9) + 7] & 0x7F,
    ((v26[8 * i + 6]&0xFF) >> 6) & 2 | ((v26[8 * i + 5]&0xFF) >> 5) & 4 | ((v26[8 * i + 4]&0xFF) >> 4) & 8 | ((v26[8 * i + 3]&0xFF) >> 3) & 0x10 | ((v26[8 * i + 2]&0xFF) >> 2) & 0x20 | ((v26[8 * i + 1]&0xFF) >> 1) & 0x40 | ((v26[8 * i + 7]&0xFF) >> 7))
    v23 = (v26[8 * i]&0xFF) >> 7
    v22 |= v23 << 63
    s.add(v22 == correct[i])
if(s.check() == sat):
    m = s.model()
    result = [m[v26[i]].as_long() for i in range(len(v26))]
    print(result)
```
# Math 3
## Detailed Analysis
## Script and Flag
```python
# z3 my beloved <3 
from z3 import *
SHUFFLE = [  0x02, 0x06, 0x07, 0x01, 0x05, 0x0B, 0x09, 0x0E, 0x03, 0x0F, 0x04, 0x08, 0x0A, 0x0C, 0x0D, 0x00]
ADD32 = [0xDEADBEEF, 0xFEE1DEAD, 0x13371337, 0x67637466]
XOR = [0x76, 0x58, 0xB4, 0x49, 0x8D, 0x1A, 0x5F, 0x38, 0xD4, 0x23, 0xF8, 0x34, 0xEB, 0x86, 0xF9, 0xAA]
flag = [BitVec('x[%d]'%i,8) for i in range(16)]
s = Solver()
temp = [0]*len(flag)
for i in range(len(flag)):
    temp[i] = flag[SHUFFLE[i]]
cond = Concat(temp[3],temp[2],temp[1],temp[0])
cond1 = Concat(temp[7],temp[6],temp[5],temp[4])
cond2= Concat(temp[11],temp[10],temp[9],temp[8])
cond3 = Concat(temp[15],temp[14],temp[13],temp[12])
    
sum= (cond+ADD32[0])&0xFFFFFFFF
sum1= (cond1+ADD32[1])&0xFFFFFFFF
sum2= (cond2+ADD32[2])&0xFFFFFFFF
sum3= (cond3+ADD32[3])&0xFFFFFFFF

temp[0] = Extract(7, 0, sum)
temp[1] = Extract(15, 8, sum)
temp[2] = Extract(23, 16, sum)
temp[3] = Extract(31, 24, sum)
temp[4] = Extract(7, 0, sum1)
temp[5] = Extract(15, 8, sum1)
temp[6] = Extract(23, 16, sum1)
temp[7] = Extract(31, 24, sum1)
temp[8] = Extract(7, 0, sum2)
temp[9] = Extract(15, 8, sum2)
temp[10] = Extract(23, 16, sum2)
temp[11] = Extract(31, 24, sum2)
temp[12] = Extract(7, 0, sum3)
temp[13] = Extract(15, 8, sum3)
temp[14] = Extract(23, 16, sum3)
temp[15] = Extract(31, 24, sum3)

for i in range(len(temp)):
    temp[i] ^= XOR[i]
for i in range(len(flag)):
    s.add(flag[i] == temp[i])
if(s.check()==sat):
    m = s.model()
    result = [m[flag[i]].as_long() for i in range(16)]
for i in result:
    print(chr(i),end='')

```
